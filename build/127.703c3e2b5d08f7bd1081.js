"use strict";(self.webpackChunkpayload_template_js_blank=self.webpackChunkpayload_template_js_blank||[]).push([[127],{89127:(e,a,l)=>{l.r(a),l.d(a,{default:()=>D});var t=l(67294),i=l(16550),s=l(9980),n=l(28630),d=l(75091),o=l(47489),r=l(40684),c=l(2143),m=l(49546),v=l(28584),u=l(11687),p=l(4983),b=l(46268),f=l(5590),E=l(55532),_=l(37276),g=l(89877),Z=l(50854),h=l(8742),N=l(28019),S=l(40829),w=l(45074),k=l(8792),y=l(11750),$=l(24531),L=l(17095),P=l(9684),U=l(69850);l(88446);const R="global-edit",A=e=>{var a,l,i,n,d,o,r,c,A,C,F,D,T,I,j,x;const{admin:{dateFormat:M}}=(0,s.Z)(),{publishedDoc:O}=(0,w.x5)(),{global:V,data:G,onSave:H,permissions:K,action:q,apiURL:z,initialState:B,isLoading:J}=e,{fields:Q,preview:W,versions:X,label:Y,admin:{description:ee,hideAPIURL:ae}={}}=V,le=null===(a=null==K?void 0:K.update)||void 0===a?void 0:a.permission;return t.createElement("div",{className:R},J&&t.createElement(S.Z,null),!J&&t.createElement(P.R.Provider,{value:"update"},t.createElement(u.Z,{className:"global-edit__form",method:"post",action:q,onSuccess:H,disabled:!le,initialState:B},t.createElement("div",{className:"global-edit__main"},t.createElement(_.Z,{title:Y,description:Y,keywords:`${Y}, Payload, CMS`}),t.createElement(v.Z,null),!((null===(l=V.versions)||void 0===l?void 0:l.drafts)&&(null===(n=null===(i=V.versions)||void 0===i?void 0:i.drafts)||void 0===n?void 0:n.autosave))&&t.createElement(Z.Z,null),t.createElement(U.T,{className:"global-edit__edit"},t.createElement("header",{className:"global-edit__header"},t.createElement("h1",null,"Edit"," ",Y),ee&&t.createElement("div",{className:"global-edit__sub-header"},t.createElement(N.Z,{description:ee}))),t.createElement(f.Z,{readOnly:!le,permissions:K.fields,filter:e=>!e.admin.position||e.admin.position&&"sidebar"!==e.admin.position,fieldTypes:g.Z,fieldSchema:Q}))),t.createElement("div",{className:"global-edit__sidebar-wrap"},t.createElement("div",{className:"global-edit__sidebar"},t.createElement("div",{className:"global-edit__sidebar-sticky-wrap"},t.createElement("div",{className:"global-edit__document-actions"+((null===(d=V.versions)||void 0===d?void 0:d.drafts)&&!(null===(r=null===(o=V.versions)||void 0===o?void 0:o.drafts)||void 0===r?void 0:r.autosave)||W?" global-edit__document-actions--has-2":"")},W&&(!(null===(c=V.versions)||void 0===c?void 0:c.drafts)||(null===(C=null===(A=V.versions)||void 0===A?void 0:A.drafts)||void 0===C?void 0:C.autosave))&&t.createElement(p.Z,{generatePreviewURL:W,data:G}),le&&t.createElement(t.Fragment,null,(null===(F=V.versions)||void 0===F?void 0:F.drafts)&&t.createElement(t.Fragment,null,!V.versions.drafts.autosave&&t.createElement(k.Z,null),t.createElement(y.Z,null)),!(null===(D=V.versions)||void 0===D?void 0:D.drafts)&&t.createElement(b.Z,{buttonId:"action-save"},"Save"))),t.createElement("div",{className:"global-edit__sidebar-fields"},W&&(null===(T=V.versions)||void 0===T?void 0:T.drafts)&&!(null===(j=null===(I=V.versions)||void 0===I?void 0:I.drafts)||void 0===j?void 0:j.autosave)&&t.createElement(p.Z,{generatePreviewURL:W,data:G}),(null===(x=V.versions)||void 0===x?void 0:x.drafts)&&t.createElement(t.Fragment,null,t.createElement($.Z,null),V.versions.drafts.autosave&&le&&t.createElement(L.Z,{publishedDocUpdatedAt:(null==O?void 0:O.updatedAt)||(null==G?void 0:G.createdAt),global:V})),t.createElement(f.Z,{readOnly:!le,permissions:K.fields,filter:e=>"sidebar"===e.admin.position,fieldTypes:g.Z,fieldSchema:Q})),t.createElement("ul",{className:"global-edit__meta"},X&&t.createElement("li",null,t.createElement("div",{className:"global-edit__label"},"Versions"),t.createElement(h.Z,{global:V})),G&&!ae&&t.createElement("li",{className:"global-edit__api-url"},t.createElement("span",{className:"global-edit__label"},"API URL"," ",t.createElement(E.Z,{value:z})),t.createElement("a",{href:z,target:"_blank",rel:"noopener noreferrer"},z)),G.updatedAt&&t.createElement("li",null,t.createElement("div",{className:"global-edit__label"},"Last Modified"),t.createElement("div",null,(0,m.default)(new Date(G.updatedAt),M))))))))))};var C=l(19826),F=l(91455);const D=e=>{var a,l;const{state:m}=(0,i.TH)(),v=(0,r.bU)(),{setStepNav:u}=(0,d.FP)(),{permissions:p,user:b}=(0,n.a)(),[f,E]=(0,t.useState)(),{getVersions:_,preferencesKey:g}=(0,w.x5)(),{getPreference:Z}=(0,F.G)(),{serverURL:h,routes:{api:N}}=(0,s.Z)(),{global:S}=e,{slug:k,label:y,fields:$,admin:{components:{views:{Edit:L}={}}={}}={}}=S,P=(0,t.useCallback)((async e=>{_();const a=await(0,C.Z)({fieldSchema:$,data:e.result,operation:"update",user:b,locale:v});E(a)}),[_,$,b,v]),[{data:U}]=(0,o.Z)(`${h}${N}/globals/${k}`,{initialParams:{"fallback-locale":"null",depth:0,draft:"true"}}),R=(null==m?void 0:m.data)||U;(0,t.useEffect)((()=>{u([{label:y}])}),[u,y]),(0,t.useEffect)((()=>{(async()=>{const e=await(0,C.Z)({fieldSchema:$,data:R,user:b,operation:"update",locale:v});await Z(g),E(e)})()}),[R,$,b,v,Z,g]);const D=null===(a=null==p?void 0:p.globals)||void 0===a?void 0:a[k];return t.createElement(c.Z,{DefaultComponent:A,CustomComponent:L,componentProps:{isLoading:!f,data:R,permissions:D,initialState:f,global:S,onSave:P,apiURL:`${h}${N}/globals/${k}${(null===(l=S.versions)||void 0===l?void 0:l.drafts)?"?draft=true":""}`,action:`${h}${N}/globals/${k}?locale=${v}&depth=0&fallback-locale=null`}})}}}]);